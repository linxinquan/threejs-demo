"use strict";(self.webpackChunkself_create=self.webpackChunkself_create||[]).push([[932],{3063:(e,t,n)=>{n.d(t,{P7:()=>b,U_:()=>w});var r=n(3205),i=n(7294),a=n(758),o=n(2367),s=n(9755),c=n(9532),l=n(8008),u=n(5007),d=n(3171),v=n(9464),h=n(4218);function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(f=function(){return!!e})()}var m=function(e){function t(e){var n,i,a,s;(0,o.A)(this,t),i=this,a=t,a=(0,l.A)(a),n=(0,c.A)(i,f()?Reflect.construct(a,[],(0,l.A)(i).constructor):a.apply(i,s)),(0,r.A)(n,"animationId",-1),(0,r.A)(n,"destroyed",!1),(0,r.A)(n,"handleWindowResize",(function(){n.renderer.setSize(n.domElement.clientWidth,n.domElement.clientHeight);var e=n.domElement.clientWidth/n.domElement.clientHeight;n.updateFrustum(e)})),n.domElement=e;var u=e.clientWidth,h=e.clientHeight;return n.renderer=new d.JeP,n.scene=new v.Z58,n.scene.background=new v.Q1f(657930),n.renderer.setSize(u,h),n.initCamera("orthographic"),n.domElement.append(n.renderer.domElement),n.initCameraControls(),n.addLight(),n.resize(),n}return(0,u.A)(t,e),(0,s.A)(t,[{key:"dispose",value:function(){this.renderer.dispose(),window.removeEventListener("resize",this.handleWindowResize)}},{key:"initCameraControls",value:function(){var e=this,t=new h.N(this.camera,this.renderer.domElement);this.controls=t,t.addEventListener("change",(function(){e.render()}))}},{key:"initCamera",value:function(e){var t="perspective"===e,n=this.domElement.clientWidth/this.domElement.clientHeight;if(t)this.camera=new v.ubm(50,n,.1,2e3),this.camera.position.set(0,0,50);else{this.camera=new v.qUd(-500,500,500/n,-500/n,.1,2e3),this.camera.position.set(0,0,60)}}},{key:"addLight",value:function(){var e=new v.ZyN(16777215,1.5),t=new v.$p8(16777215,Math.PI);e.position.set(5,20,-5),t.position.set(0,20,0),this.add(t,e)}},{key:"setControlEnabled",value:function(e){this.controls.enabled=e}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"add",value:function(){var e;(e=this.scene).add.apply(e,arguments)}},{key:"cleanup",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter(Boolean);r.forEach((function(e){e.removeFromParent(),requestIdleCallback((function(){e.traverse((function(e){return function(e){null==e||e.dispatchEvent({type:"removed"}),e.geometry&&(e.geometry.dispose(),delete e.geometry)}(e)}))}))})),r.length&&this.render()}},{key:"resize",value:function(){window.addEventListener("resize",this.handleWindowResize)}},{key:"updateFrustum",value:function(e){if(this.camera instanceof v.qUd){var t=this.camera.right;this.camera.left=-t,this.camera.right=t,this.camera.top=t/e,this.camera.bottom=-t/e,this.camera.updateProjectionMatrix()}else this.camera instanceof v.ubm&&(this.camera.aspect=e,this.camera.updateProjectionMatrix())}},{key:"renderSync",value:function(){this.destroyed||(this.render(),this.dispatchEvent({type:"afterRender"}))}},{key:"animate",value:function(e){this.renderSync(),this.animationId=requestAnimationFrame(this.animate.bind(this,e)),e&&!this.destroyed&&e()}},{key:"cancelAnimate",value:function(){-1!==this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=-1),this.renderSync()}}])}(function(){return(0,s.A)((function e(){(0,o.A)(this,e),this.listeners=new Map,this.tracedTypeSet=new Set}),[{key:"addEventListener",value:function(e,t){var n=this.listeners.get(e);n||(n=[],this.listeners.set(e,n)),n.includes(t)||n.push(t)}},{key:"removeEventListener",value:function(e,t){var n=this.listeners.get(e);if(n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},{key:"hasEventListener",value:function(e,t){var n=this.listeners.get(e);return!!n&&n.includes(t)}},{key:"getEventListeners",value:function(e){return this.listeners.get(e)}},{key:"dispatchEvent",value:function(e){var t=this.listeners.get(e.type);if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r+=1)n[r].call(this,e);e.target=null}this.log(e)}},{key:"trace",value:function(){var e=this;(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(t){return e.tracedTypeSet.add(t)}))}},{key:"log",value:function(e){if(this.tracedTypeSet.has(e.type)){var t=this.getEventListeners(e.type)||[];console.log("".concat(e.type," event executed ").concat(t.length," listeners")),console.log(t)}}}])}()),p=n(6070);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=(0,a.createContext)(null);function x(e){var t=(0,a.useState)(null),n=(0,i.A)(t,2),r=n[0],o=n[1],s=(0,a.useCallback)((function(e){o((function(){return e?new m(e):(null==r||r.dispose(),null)}))}),[]);(0,a.useEffect)((function(){return function(){r&&r.dispose()}}));var c="inner"===e.mode?e.style||{}:{position:"absolute",top:0,right:0,bottom:0,left:0,userSelect:"none"};return(0,p.jsxs)(b.Provider,{value:r,children:[(0,p.jsx)("div",{ref:s,style:c}),r&&e.children]})}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){return(0,p.jsx)(x,g(g({},t),{},{children:(0,p.jsx)(e,g({},n))}))}}},8932:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var r=n(7294),i=n(1952),a=n(1606),o=n(758),s=n(8674),c=n(8073),l=n(9464),u=n(3063),d=n(2367),v=n(9755),h="void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );}",f="uniform vec3 color; void main() {gl_FragColor = vec4(color, 1.0 );}",m=function(){return(0,v.A)((function e(t){(0,d.A)(this,e),this.renderer=t;var n=new l.iNn(10,15,10);this.material=new l.BKk({uniforms:{color:{value:new l.Q1f(12277848)}},vertexShader:h,fragmentShader:f}),this.obj=new l.eaF(n,this.material),this.renderer.add(this.obj),this.renderer.render()}),[{key:"updateVertex",value:function(e){this.material.vertexShader=e,this.material.needsUpdate=!0,this.renderer.render()}},{key:"updateFragment",value:function(e){this.material.fragmentShader=e,this.material.needsUpdate=!0,this.renderer.render()}},{key:"setUniform",value:function(e,t){this.material.uniforms[e]={value:t},this.material.needsUpdate=!0,this.renderer.render()}},{key:"updateGeom",value:function(e){switch(e){case"box":this.obj.geometry=new l.iNn(10,15,10);break;case"sphere":this.obj.geometry=new l.Gu$(10,15,10);break;case"cylinder":this.obj.geometry=new l.Ho_(10,10,15,15);break;case"plane":this.obj.geometry=new l.bdM(20,20)}this.renderer.render()}}])}(),p=n(6302),y=n.n(p),g=n(4615),b=n.n(g),x=n(1117),w=n.n(x),j=n(174),k=n.n(j),A=n(5258),E=n.n(A),P=n(4671),C=n.n(P),U=n(4376),S={};S.styleTagTransform=C(),S.setAttributes=k(),S.insert=w().bind(null,"head"),S.domAPI=b(),S.insertStyleElement=E(),y()(U.A,S);const O=U.A&&U.A.locals?U.A.locals:void 0;var V=n(6070),F=i.A.TextArea;const _=(0,u.U_)((function(){var e=(0,o.useContext)(u.P7),t=(0,s.A)((function(){return new m(e)}),[e]),n=(0,o.useRef)(),d=(0,o.useRef)({color:"#bb5858"});return(0,o.useEffect)((function(){return n.current=new c.Ay,n.current.addColor(d.current,"color").onChange((function(e){t.setUniform("color",new l.Q1f(e))})),function(){n.current&&n.current.destroy()}}),[]),(0,V.jsxs)("div",{className:O.container,children:[(0,V.jsxs)("div",{children:["选择图形",(0,V.jsx)(a.A,{defaultValue:"box",options:[{value:"box",label:"box"},{value:"sphere",label:"sphere"},{value:"cylinder",label:"cylinder"},{value:"plane",label:"plane"}],onChange:function(e){t.updateGeom(e)}})]}),(0,V.jsxs)("div",{children:["选择内置shader",(0,V.jsx)(a.A,{options:[{value:"border",label:"border"},{value:"stripe",label:"stripe"}],onChange:function(e){switch(e){case"border":t.updateVertex("varying vec2 vUv;\r\nvoid main() {\r\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\r\n    vUv = uv;\r\n}"),t.updateFragment("uniform vec3 color;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n    gl_FragColor = vec4(color, 1.0 );\r\n\r\n    float yPos = step(abs(vUv.y - 0.5), 0.4);\r\n    float xPos = step(abs(vUv.x - 0.5), 0.4);\r\n    gl_FragColor = mix(vec4(0.,0.,0.,1.),vec4(color,1.0), yPos * xPos);\r\n}\r\n");break;case"stripe":t.updateVertex("varying vec2 vUv;\r\n\r\nvoid main() {\r\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.0);\r\n    vUv = uv;\r\n}"),t.updateFragment("uniform vec3 color;\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n    float uSlope = 0.4;\r\n    float repeatTime = 4.;\r\n    // 倾斜后的uv坐标\r\n    vec2 slopeUv = vec2(vUv.x + uSlope * vUv.y, vUv.y);\r\n    vec3 lineColor = vec3(1.,1.,1.);\r\n    // 生成重复条纹\r\n    vec3 color = mix(color, lineColor, step(0.5, fract(slopeUv.x * repeatTime)));\r\n    gl_FragColor = vec4(color, 1.0);\r\n    #include <colorspace_fragment>\r\n}")}}})]}),(0,V.jsxs)("div",{children:[(0,V.jsx)("div",{children:"set uniform"}),(0,V.jsx)(i.A,{onBlur:function(e){var n,i,a,o;n=e.target.value.split(","),a=(i=(0,r.A)(n,2))[0],o=i[1],t.setUniform(a,o)}})]}),(0,V.jsxs)("div",{children:[(0,V.jsx)("div",{children:"vertex shader"}),(0,V.jsx)(F,{defaultValue:h,onBlur:function(e){var n;n=e.target.value,t.updateVertex(n)}})]}),(0,V.jsxs)("div",{children:[(0,V.jsx)("div",{children:"fragment shader"}),(0,V.jsx)(F,{defaultValue:f,onBlur:function(e){var n;n=e.target.value,t.updateFragment(n)}})]})]})}))},4376:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(9013),i=n.n(r),a=n(8454),o=n.n(a)()(i());o.push([e.id,".iQQV6A4gQVVcikAc7dgp {\n  position: absolute;\n  top: 0;\n  width: 300px;\n}\n",""]),o.locals={container:"iQQV6A4gQVVcikAc7dgp"};const s=o}}]);